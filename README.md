# zzdns

## 简介

喳喳DNS是一款本地DNS服务器。

工作原理: 

当收到客户端发起的DNS请求, 将会进行解析DNS报文:
- 如果不是A记录, 那么直接同时将请求转发到配置好的多个上游DNS服务器, 其中某个上游DNS最先返回结果后, 将直接将DNS响应到客户端。
- 如果是A记录, 判断当前请求的域名是否有缓存结果:
    - 有, 则将缓存的结果返回到客户端。
    - 没有, 则同时请求多个上游DNS服务器, 获取到响应最快的报文, 随机设置TTL的报文为3-5s后过期, 然后将报文返回到客户端。
    后台线程再对此次请求的记录解析, 如果有多个IP则进行测速, 仅保存最快的一个IP，然后缓存结果。3-5s客户端的缓存过期后，重新请求该DNS服务器，则可以直接返回缓存的内容。


域名预加载:

- 在DNS服务启动的同时会开启一个线程预先缓存一些常用站点。